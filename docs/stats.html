<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Dave Tang" />

<meta name="date" content="2024-03-30" />

<title>Learn statistics</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/darkly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/main/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="my.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Bioinformatics tips</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tips
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="get_option.html">Command line arguments</a>
    </li>
    <li>
      <a href="restful.html">APIs</a>
    </li>
    <li>
      <a href="pipelining.html">Workflow Management System</a>
    </li>
    <li>
      <a href="security.html">Security basics</a>
    </li>
  </ul>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/davetang/bioinformatics_tips">
    <span class="fab fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Learn statistics</h1>
<h4 class="author">Dave Tang</h4>
<h4 class="date">2024-03-30</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span>
workflowr <span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2024-03-30
</p>
<p>
<strong>Checks:</strong> <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>bioinformatics_tips/</code> <span
class="glyphicon glyphicon-question-sign" aria-hidden="true"
title="This is the local directory in which the code in this file was executed.">
</span>
</p>
<p>
This reproducible <a href="https://rmarkdown.rstudio.com">R Markdown</a>
analysis was created with <a
  href="https://github.com/workflowr/workflowr">workflowr</a> (version
1.7.1). The <em>Checks</em> tab describes the reproducibility checks
that were applied when the results were created. The <em>Past
versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date
</a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git
repository, you know the exact version of the code that produced these
results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the
global environment can affect the analysis in your R Markdown file in
unknown ways. For reproduciblity it’s best to always run the code in an
empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20200503code">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Seed:</strong>
<code>set.seed(20200503)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20200503code"
class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20200503)</code> was run prior to running
the code in the R Markdown file. Setting a seed ensures that any results
that rely on randomness, e.g. subsampling or permutations, are
reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Session information:</strong>
recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package
versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be
confident that you successfully produced the results during this
run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr
project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomdavetangbioinformaticstipstree60d8e9ce3f64265a45e71e9dd336c0516fbfec15targetblank60d8e9ca">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Repository version:</strong>
<a href="https://github.com/davetang/bioinformatics_tips/tree/60d8e9ce3f64265a45e71e9dd336c0516fbfec15" target="_blank">60d8e9c</a>
</a>
</p>
</div>
<div
id="strongRepositoryversionstrongahrefhttpsgithubcomdavetangbioinformaticstipstree60d8e9ce3f64265a45e71e9dd336c0516fbfec15targetblank60d8e9ca"
class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development
and connecting the code version to the results is critical for
reproducibility.
</p>
<p>
The results in this page were generated with repository version
<a href="https://github.com/davetang/bioinformatics_tips/tree/60d8e9ce3f64265a45e71e9dd336c0516fbfec15" target="_blank">60d8e9c</a>.
See the <em>Past versions</em> tab to see a history of the changes made
to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for
the analysis have been committed to Git prior to generating the results
(you can use <code>wflow_publish</code> or
<code>wflow_git_commit</code>). workflowr only checks the R Markdown
file, but you know if there are other scripts or data files that it
depends on. Below is the status of the Git repository when the results
were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rproj.user/

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not
included in this status report because it is ok for generated content to
have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were
made to the R Markdown (<code>analysis/stats.Rmd</code>) and HTML
(<code>docs/stats.html</code>) files. If you’ve configured a remote Git
repository (see <code>?wflow_git_remote</code>), click on the hyperlinks
in the table below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/davetang/bioinformatics_tips/blob/60d8e9ce3f64265a45e71e9dd336c0516fbfec15/analysis/stats.Rmd" target="_blank">60d8e9c</a>
</td>
<td>
Dave Tang
</td>
<td>
2024-03-30
</td>
<td>
t-test
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/davetang/bioinformatics_tips/870424f76e381980064b3a32b86aab70db878b12/docs/stats.html" target="_blank">870424f</a>
</td>
<td>
Dave Tang
</td>
<td>
2024-03-28
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/davetang/bioinformatics_tips/blob/601941ca1b6aa95ff7427340b8894d440117b395/analysis/stats.Rmd" target="_blank">601941c</a>
</td>
<td>
Dave Tang
</td>
<td>
2024-03-28
</td>
<td>
Variance of a sample versus variance of means
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/davetang/bioinformatics_tips/5d868bf8ff5dc78a49169b2707991c05ab318be2/docs/stats.html" target="_blank">5d868bf</a>
</td>
<td>
Dave Tang
</td>
<td>
2024-03-27
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/davetang/bioinformatics_tips/blob/27510ee7a21840f3282582d129f1e44beee171fa/analysis/stats.Rmd" target="_blank">27510ee</a>
</td>
<td>
Dave Tang
</td>
<td>
2024-03-27
</td>
<td>
Comparing means
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/davetang/bioinformatics_tips/e155003e13510c94a7b5c2e1870cf289a67cc3b7/docs/stats.html" target="_blank">e155003</a>
</td>
<td>
Dave Tang
</td>
<td>
2024-03-19
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/davetang/bioinformatics_tips/blob/2c2bd87813c3b476e5ded4b26981197544e27fca/analysis/stats.Rmd" target="_blank">2c2bd87</a>
</td>
<td>
Dave Tang
</td>
<td>
2024-03-19
</td>
<td>
Median Absolute Deviation
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/davetang/bioinformatics_tips/9f1076f5b79a2deb9bf5538ed8449293393b9338/docs/stats.html" target="_blank">9f1076f</a>
</td>
<td>
Dave Tang
</td>
<td>
2024-03-19
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/davetang/bioinformatics_tips/blob/35d9b85ab5418841499cc4fb8364cf060792b8da/analysis/stats.Rmd" target="_blank">35d9b85</a>
</td>
<td>
Dave Tang
</td>
<td>
2024-03-19
</td>
<td>
Type 1 and Type 2 errors
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/davetang/bioinformatics_tips/17d7f70a4d74a74992184a64abeb58f21546b8a5/docs/stats.html" target="_blank">17d7f70</a>
</td>
<td>
Dave Tang
</td>
<td>
2024-03-19
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/davetang/bioinformatics_tips/blob/3fe5251e96543620d67217e0c5c4d1c4e99d5b19/analysis/stats.Rmd" target="_blank">3fe5251</a>
</td>
<td>
Dave Tang
</td>
<td>
2024-03-19
</td>
<td>
Data transformation
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/davetang/bioinformatics_tips/d232abba732ab5ff978411bc5eb06a1600ff730a/docs/stats.html" target="_blank">d232abb</a>
</td>
<td>
Dave Tang
</td>
<td>
2024-03-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/davetang/bioinformatics_tips/blob/0001a3a6153cd7c4f3be15276a17659c6dfdda73/analysis/stats.Rmd" target="_blank">0001a3a</a>
</td>
<td>
Dave Tang
</td>
<td>
2024-03-18
</td>
<td>
Address ggplot2 warnings
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/davetang/bioinformatics_tips/3a5bc7fc12ef91dd1d765d30554fe514ddbc51ca/docs/stats.html" target="_blank">3a5bc7f</a>
</td>
<td>
Dave Tang
</td>
<td>
2024-03-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/davetang/bioinformatics_tips/blob/5ed2a80c27836d7252093af17566c345f78ea79f/analysis/stats.Rmd" target="_blank">5ed2a80</a>
</td>
<td>
Dave Tang
</td>
<td>
2024-03-18
</td>
<td>
Include ToC
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/davetang/bioinformatics_tips/02c4da123a55f40107a580c98ab954e50f017828/docs/stats.html" target="_blank">02c4da1</a>
</td>
<td>
Dave Tang
</td>
<td>
2024-03-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/davetang/bioinformatics_tips/blob/6a40a22b16e3518e25e522ba8ab30768a5d370e4/analysis/stats.Rmd" target="_blank">6a40a22</a>
</td>
<td>
Dave Tang
</td>
<td>
2024-03-18
</td>
<td>
The normal distribution
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/davetang/bioinformatics_tips/ad4c62636d5ab47177d25aaf1a6248cbd15ab93a/docs/stats.html" target="_blank">ad4c626</a>
</td>
<td>
Dave Tang
</td>
<td>
2024-03-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/davetang/bioinformatics_tips/blob/9fc987bfc76b2446009cb75d9ed44e5f1e465acc/analysis/stats.Rmd" target="_blank">9fc987b</a>
</td>
<td>
Dave Tang
</td>
<td>
2024-03-18
</td>
<td>
Standard deviation
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/davetang/bioinformatics_tips/52ab7ed5d81886a353f904da13ec8990a513c4a8/docs/stats.html" target="_blank">52ab7ed</a>
</td>
<td>
Dave Tang
</td>
<td>
2024-03-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/davetang/bioinformatics_tips/blob/2c2f5ea209847f87f854847c38a81fa2174fc46e/analysis/stats.Rmd" target="_blank">2c2f5ea</a>
</td>
<td>
Dave Tang
</td>
<td>
2024-03-18
</td>
<td>
Why n-1 and why squared deviations?
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/davetang/bioinformatics_tips/e8368efdd4563493e75c3249c252f65a192d8c65/docs/stats.html" target="_blank">e8368ef</a>
</td>
<td>
Dave Tang
</td>
<td>
2024-03-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/davetang/bioinformatics_tips/blob/cfd0f357ae300a16c831e1dd7ab47b1abd9a774c/analysis/stats.Rmd" target="_blank">cfd0f35</a>
</td>
<td>
Dave Tang
</td>
<td>
2024-03-18
</td>
<td>
Statistics page
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="basics" class="section level2">
<h2>Basics</h2>
<p>Statistics are summaries or collections of numbers. The mean, median,
and mode are all summary statistics. When we can’t take every single
possible measurement (the population), which is often the case, we take
an estimation using a sample.</p>
<p>Statistics uses a lot of notation (usually algebraic), which is
simply a shorthand way of expressing statistical computations. Most
statistical calculations simply involve addition, subtraction,
multiplication, division, and exponentiation. Common calculations
include the “sum of cross products” and “sum of squares”:</p>
<p><span class="math display">\[
\frac{(\sum xy)^2}{\sum x^2 + \sum y^2} = \frac{(sum\ of\ cross\
products)^2}{sum\ of\ squares\ for\ x + sum\ of\ squares\ for\ y}
\]</span></p>
<p>Calculating the mean is simply:</p>
<p><span class="math display">\[
\bar{x} = \frac{\sum x}{n}
\]</span></p>
</div>
<div id="variance" class="section level2">
<h2>Variance</h2>
<p>The mean as a summary statistic is useful but it does not provide any
information on the variance. For example, the two datasets below have
the same mean but as you can see have different variances.</p>
<pre class="r"><code>x1 &lt;- c(48, 49, 49, 47, 48, 47)
x2 &lt;- c(12, 62, 3, 50, 93, 68)
mean(x1) == mean(x2)</code></pre>
<pre><code>[1] TRUE</code></pre>
<p>The easiest (but least useful) way to summarise variation is by using
the range; it’s not that useful because it uses just two values (the
lowest and highest values) from the total dataset.</p>
<pre class="r"><code>range(x1)</code></pre>
<pre><code>[1] 47 49</code></pre>
<pre class="r"><code>range(x2)</code></pre>
<pre><code>[1]  3 93</code></pre>
<p>To make the best use of the datasets, we need a statistic that uses
all the numbers. One key piece of intuition is to realise that
<strong>if all numbers are identical, there would be no variation and
the numbers would all equal the mean</strong>.</p>
<pre class="r"><code>x3 &lt;- rep(48, 6)
mean(x3)</code></pre>
<pre><code>[1] 48</code></pre>
<p>Therefore, if the numbers are not the same, each number’s
contribution to the total variation is its <em>deviation</em>
(difference) from the mean. We could add all these differences (ignoring
whether the difference is + or -) and come up with a “total deviation”:
<span class="math inline">\(\sum(x - \bar{x})\)</span>.</p>
<pre class="r"><code>sum(abs(x1 - mean(x1)))</code></pre>
<pre><code>[1] 4</code></pre>
<pre class="r"><code>sum(abs(x2 - mean(x2)))</code></pre>
<pre><code>[1] 162</code></pre>
<p>However the main problem with this method is that we can only compare
total deviations between datasets with the same number. We need a
deviation statistic that is independent of sample size, in the same way
the mean is.</p>
<p>We can divide the total deviation by the total number of numbers to
get the mean (average) deviation:</p>
<p><span class="math display">\[
\frac{\sum(x - \bar{x})}{n} = \frac{The\ sum\ of\ all\ the\ deviations\
from\ the\ mean}{The\ number\ of\ numbers}
\]</span></p>
<pre class="r"><code>sum(abs(x1 - mean(x1))) / length(x1)</code></pre>
<pre><code>[1] 0.6666667</code></pre>
<pre class="r"><code>sum(abs(x2 - mean(x2))) / length(x2)</code></pre>
<pre><code>[1] 27</code></pre>
<p>The mean average deviation is very close to the standard measure of
variation used in statistics, which is the variance.</p>
<p><span class="math display">\[
variance = \frac{\sum(x - \bar{x})^2}{n - 1} = \frac{The\ sum\ of\ all\
the\ squared\ deviations\ from\ the\ mean}{One\ less\ than\ the\ number\
of\ numbers}
\]</span></p>
<pre class="r"><code>var(x1)</code></pre>
<pre><code>[1] 0.8</code></pre>
<pre class="r"><code>var(x2)</code></pre>
<pre><code>[1] 1189.2</code></pre>
<p>The bottom part of the variance equation is known as the <em>degrees
of freedom</em> (d.f.) and the top part, <span
class="math inline">\(\sum(x - \bar{x})^2\)</span> is known as the
<em>sum of squares</em> but should really be called the <em>sum of
squares of deviations</em> since that is what we are calculating.</p>
<p>It is essential to remember that:</p>
<ul>
<li><em>Sum of squares</em> in statistics is the technical term for
<em>summed squared deviations from the mean</em>.</li>
</ul>
<div id="median-absolute-deviation" class="section level3">
<h3>Median Absolute Deviation</h3>
<blockquote>
<p>The <a
href="https://en.wikipedia.org/wiki/Median_absolute_deviation">median
absolute deviation</a> is a measure of statistical dispersion. Moreover,
the MAD is a robust statistic, being more resilient to outliers in a
data set than the standard deviation. In the standard deviation, the
distances from the mean are squared, so large deviations are weighted
more heavily, and thus outliers can heavily influence it. In the MAD,
the deviations of a small number of outliers are irrelevant.</p>
<p>Because the MAD is a more robust estimator of scale than the sample
variance or standard deviation, it works better with distributions
without a mean or variance, such as the Cauchy distribution.</p>
</blockquote>
<p>The <code>mad</code> function description:</p>
<blockquote>
<p>Compute the median absolute deviation, i.e., the (lo-/hi-) median of
the absolute deviations from the median, and (by default) adjust by a
factor for asymptotically normal consistency.</p>
</blockquote>
<p>No variance.</p>
<pre class="r"><code>mad(rep(1, 10))</code></pre>
<pre><code>[1] 0</code></pre>
<p>Single outlier.</p>
<pre class="r"><code>one_outlier &lt;- c(rep(1, 9), 100)
one_outlier</code></pre>
<pre><code> [1]   1   1   1   1   1   1   1   1   1 100</code></pre>
<pre class="r"><code>mad(one_outlier)</code></pre>
<pre><code>[1] 0</code></pre>
<p>Same median.</p>
<pre class="r"><code>four_outlier &lt;- c(rep(1, 6), rep(100, 4))
four_outlier</code></pre>
<pre><code> [1]   1   1   1   1   1   1 100 100 100 100</code></pre>
<pre class="r"><code>mad(four_outlier)</code></pre>
<pre><code>[1] 0</code></pre>
<p>Cauchy Distribution.</p>
<pre class="r"><code>set.seed(1984)
x &lt;- rcauchy(n = 1000, location = 1, scale = 2)
hist(x, breaks = 10)
abline(v = mean(x), col = 2, lty = 2)</code></pre>
<p><img src="figure/stats.Rmd/cauchy_dist-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-cauchy_dist-1">
Past versions of cauchy_dist-1.png
</button>
</p>
<div id="fig-cauchy_dist-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/davetang/bioinformatics_tips/blob/e155003e13510c94a7b5c2e1870cf289a67cc3b7/docs/figure/stats.Rmd/cauchy_dist-1.png" target="_blank">e155003</a>
</td>
<td>
Dave Tang
</td>
<td>
2024-03-19
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Mean and median.</p>
<pre class="r"><code>mean(x)</code></pre>
<pre><code>[1] 2.151276</code></pre>
<pre class="r"><code>median(x)</code></pre>
<pre><code>[1] 1.063466</code></pre>
<p>SD and MAD.</p>
<pre class="r"><code>sd(x)</code></pre>
<pre><code>[1] 40.77717</code></pre>
<pre class="r"><code>mad(x)</code></pre>
<pre><code>[1] 3.006772</code></pre>
</div>
</div>
<div id="why-n---1" class="section level2">
<h2>Why n - 1?</h2>
<p>The two important basics of degrees of freedom are:</p>
<ol style="list-style-type: decimal">
<li>We are calculating statistics from just a small sample rather than
the entire population of numbers and</li>
<li>The mean that is used as the basis for the deviations that
contribute to the sum of squares is based on the <strong>total</strong>
of just that small sample.</li>
</ol>
<p>In ignorance of the true mean of the population, we are forced into
using the total of our sample to calculate a mean from which the
deviations are then calculated. It is that use of the
<strong>total</strong> which restricts our freedom from <span
class="math inline">\(n\)</span> to <span class="math inline">\(n -
1\)</span>. If we used the true mean of the population and not the mean
of the sample in calculating the sum of squares, we would divide by
<span class="math inline">\(n\)</span> instead.</p>
<p>As an analogy imagine a bookshelf and that we are trying to work out
the mean thickness of all the books. We take a small sample of six
books. and their combined thickness is 158 mm giving a mean of 26.3 mm.
We need to know the individual deviation from the mean for each of the
six books to calculate the variance.</p>
<p>We measure the thickness of one book (1 d.f.) and it is 22mm. The
remaining five books must total <span class="math inline">\(158 - 22 =
136mm\)</span> in thickness. We measure one more book (2 d.f.) and it is
24 mm thick. By the time, we measured the fifth book (fifth degree of
freedom), the combined thickness is 129 mm. <strong>There are no more
degrees of freedom for the six books!</strong> We do not need to pick up
and measure the last book; it must be <span class="math inline">\(158 -
129 = 29mm\)</span>. Therefore, given the mean of the sample, we know
<strong>the total thickness of the six books</strong> and from this the
individual thicknesses of all six books after measuring only five (hence
5 d.f. for a sample of six!).</p>
<p>By using the sample mean as the base from which to calculate the
deviations for the sum of squares, we have lost 1 d.f. Thus variance is
not the simple mean of the squared deviations, it is the squared
deviation per <strong>opportunity for variation</strong> once we have
been given the sample mean.</p>
</div>
<div id="why-are-the-deviations-squared" class="section level2">
<h2>Why are the deviations squared?</h2>
<p><a href="https://math.stackexchange.com/a/937602">You might</a> look
at your data as measured in a multidimensional space, where each subject
is a dimension and each item is a vector in that space from the origin
towards the items’ measurement over the full subject’s space.</p>
<p>Additional remark: this view of things has an additional nice flavour
because it uncovers the condition, that the subjects are assumed
independent of each other. This is to have the data-space Euclidean;
changes in that independence-condition require then changes in the
mathematics of the space: it has correlated (or “oblique”) axes.</p>
<p>Now the distance of one vector-arrowhead to another is just the
formula for distances in the Euclidean space, the square root of squares
of distances-of-coordinates (from the Pythagorean theorem):</p>
<p><span class="math display">\[
d = \sqrt{(x_1 - y_1)^2 + (x_2 - y_2)^2 + \cdots + (x_n - y_n)^2}
\]</span></p>
<p>And the standard deviation is that value, normalised by the number of
subjects, if the mean-vector is taken as the y-vector.</p>
<p><span class="math display">\[
s = \sqrt{\frac{(x_1 - \bar{x})^2 + (x_2 - \bar{x})^2 + \cdots + (x_n -
\bar{x})^2}{n}}
\]</span></p>
</div>
<div id="the-standard-deviation" class="section level2">
<h2>The standard deviation</h2>
<p>Standard deviation is the square root of variance.</p>
<pre class="r"><code>sd(x1) == sqrt(var(x1))</code></pre>
<pre><code>[1] TRUE</code></pre>
<pre class="r"><code>sd(x2)</code></pre>
<pre><code>[1] 34.48478</code></pre>
<p>In the case of <code>x2</code> the mean and standard deviation is
<span class="math inline">\(48.0 \pm 34.5\)</span>, which suggests
variation between <span class="math inline">\(48.0-34.5=13.5\)</span>
and <span class="math inline">\(48.0+34.5=82.5\)</span>.</p>
<p>The standard deviation was once called <em>root mean square
deviation</em>. This was a helpful name as it reminds us of the
calculation in reverse (deviation, square, mean, root), where mean is
<span class="math inline">\(n -1\)</span>.</p>
<p><span class="math display">\[
s = \sqrt{\frac{\sum (x - \bar{x})^2}{n - 1}}
\]</span></p>
</div>
<div id="the-normal-distribution" class="section level2">
<h2>The normal distribution</h2>
<p>The word <em>distribution</em> is short for <em>frequency
distribution</em>, i.e., the frequency with which different numbers are
found in a population. The normal distribution is a particular pattern
of variation of numbers around the mean. It is symmetrical with the
frequency of individual numbers falling off equally away from the mean
in both directions.</p>
<p><a
href="https://ekamperi.github.io/mathematics/2021/01/29/why-is-normal-distribution-so-ubiquitous.html">One
argument (and demonstration)</a> for why normal distributions are so
common:</p>
<blockquote>
<p>because many variables in the real world are the sum of other
independent variables. And, when independent variables are added
together, their sum converges to a normal distribution.</p>
</blockquote>
<p>Read in example dataset containing the height (inches) and weights
(pounds) of 25,000 different humans of 18 years of age (that are
converted back to cms and kgs).</p>
<pre class="r"><code>readr::read_csv(
  file = &quot;data/SOCR-HeightWeight.csv.gz&quot;,
  show_col_types = FALSE,
  col_names = c(&#39;index&#39;, &#39;height&#39;, &#39;weight&#39;),
  skip = 1
) |&gt;
  dplyr::mutate(height = height * 2.54) |&gt;
  dplyr::mutate(weight = weight / 2.205) -&gt; socr

tail(socr)</code></pre>
<pre><code># A tibble: 6 × 3
  index height weight
  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 24995   171.   57.9
2 24996   177.   53.5
3 24997   164.   54.5
4 24998   164.   53.6
5 24999   172.   60.0
6 25000   175.   56.6</code></pre>
<p>Plot distribution of heights.</p>
<pre class="r"><code>library(ggplot2)
ggplot(socr, aes(height)) +
  geom_histogram(
    aes(y = after_stat(density)),
    bins = 30,
    colour = &quot;#000000&quot;,
    fill = &quot;#FFFFFF&quot;
  ) +
  geom_density() +
  geom_vline(
    xintercept = mean(socr$height),
    colour = &quot;#990000&quot;,
    lty = 2
  ) +
  theme_minimal() +
  ggtitle(&quot;Distribution of heights in 25,000 18 year olds&quot;) +
  NULL</code></pre>
<p><img src="figure/stats.Rmd/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-3-1">
Past versions of unnamed-chunk-3-1.png
</button>
</p>
<div id="fig-unnamed-chunk-3-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/davetang/bioinformatics_tips/blob/02c4da123a55f40107a580c98ab954e50f017828/docs/figure/stats.Rmd/unnamed-chunk-3-1.png" target="_blank">02c4da1</a>
</td>
<td>
Dave Tang
</td>
<td>
2024-03-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We can see that the mean height coincides with the most frequent
height and that the heights are symmetrical about the mean.</p>
<p>The mean and standard deviation is <span class="math inline">\(172.70
\pm 4.83\)</span>.</p>
<pre class="r"><code>mean(socr$height)</code></pre>
<pre><code>[1] 172.7025</code></pre>
<pre class="r"><code>sd(socr$height)</code></pre>
<pre><code>[1] 4.830264</code></pre>
<p>In a normal distribution, 68% of the data lie between the mean <span
class="math inline">\(\pm\)</span> 1 <span
class="math inline">\(s\)</span>, which is what we observe in this
dataset.</p>
<pre class="r"><code>x &lt;- mean(socr$height)
s &lt;- sd(socr$height)

prop.table(table(socr$height &gt; x - s &amp; socr$height &lt; x + s))</code></pre>
<pre><code>
  FALSE    TRUE 
0.31644 0.68356 </code></pre>
<p>95% of the data lie between the mean <span
class="math inline">\(\pm\)</span> 2 <span
class="math inline">\(s\)</span>, which is true again in this
dataset.</p>
<pre class="r"><code>x &lt;- mean(socr$height)
s &lt;- sd(socr$height)

prop.table(table(socr$height &gt; x - 2 * s &amp; socr$height &lt; x + 2 * s))</code></pre>
<pre><code>
 FALSE   TRUE 
0.0454 0.9546 </code></pre>
<div id="checking-for-normality" class="section level3">
<h3>Checking for normality</h3>
<blockquote>
<p><a href="https://en.wikipedia.org/wiki/Q%E2%80%93Q_plot">In
statistics</a>, a Q–Q plot (quantile–quantile plot) is a probability
plot, a graphical method for comparing two probability distributions by
plotting their quantiles against each other.</p>
</blockquote>
<p>The <code>qqnorm</code> function produces a normal Q-Q plot (where
the x-axis contains the theoretical quantiles of a normal distribution);
the <code>qqline</code> function adds a line to the “theoretical” Q-Q
plot. Our height data fits the theoretical line almost perfectly.</p>
<pre class="r"><code>qqnorm(socr$height, pch = 16)
qqline(socr$height, col = 2, lty = 2)</code></pre>
<p><img src="figure/stats.Rmd/qqnorm-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-qqnorm-1">
Past versions of qqnorm-1.png
</button>
</p>
<div id="fig-qqnorm-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/davetang/bioinformatics_tips/blob/02c4da123a55f40107a580c98ab954e50f017828/docs/figure/stats.Rmd/qqnorm-1.png" target="_blank">02c4da1</a>
</td>
<td>
Dave Tang
</td>
<td>
2024-03-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>However, biological data is typically not normally distributed but
are asymmetrical. We often find data peak well to the left with a long
right tail. The mean of the distribution will not coincide with the peak
of the data and therefore using the normal distribution is clearly not
appropriate.</p>
<p>Another important point is our estimate of the standard deviation,
which is based on a sample of the population. If our sample size is too
small, our estimate of the standard deviation can be very inaccurate and
therefore our estimate of the distribution.</p>
<p>If a distribution is non-normal, a function such as logarithm or
square root can be used to normalise the distribution; this is known as
<a
href="https://www.biostathandbook.com/transformation.html">transformation</a>.</p>
<p>To illustrate transformation we will <a
href="https://www.biostathandbook.com/transformation.html">use data</a>
showing the abundance of the fish species <em>Umbra pygmaea</em>
(Eastern mudminnow) in Maryland streams, which is non-normally
distributed; there are a lot of streams with a small density of
mudminnows, and a few streams with lots of them. Below are 12 numbers
from the mudminnow data set.</p>
<pre class="r"><code>library(ggridges)
library(ggplot2)

tibble::tibble(
  raw = c(38, 1, 13, 2, 13, 20, 50, 9, 28, 6, 4, 43)
) |&gt;
  dplyr::mutate(stream = dplyr::row_number()) |&gt;
  dplyr::mutate(sqrt = sqrt(raw)) |&gt;
  dplyr::mutate(log = log(raw)) |&gt;
  dplyr::mutate(reciprocal = 1/raw) |&gt;
  dplyr::mutate(arcsine = asin(sqrt(raw/max(raw)))) |&gt;
  dplyr::select(stream, dplyr::everything()) |&gt;
  tidyr::pivot_longer(-stream, names_to = &#39;transformation&#39;) |&gt;
  dplyr::mutate(transformation = factor(transformation, levels = c(&#39;log&#39;, &#39;reciprocal&#39;, &#39;arcsine&#39;, &#39;sqrt&#39;, &#39;raw&#39;))) -&gt; mudminnow

ggplot(mudminnow, aes(x = value, y = transformation, fill = transformation)) +
  geom_density_ridges(alpha=0.6, stat=&quot;binline&quot;, bins=30) +
  theme_ridges() +
  NULL</code></pre>
<p><img src="figure/stats.Rmd/mudminnow-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-mudminnow-1">
Past versions of mudminnow-1.png
</button>
</p>
<div id="fig-mudminnow-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/davetang/bioinformatics_tips/blob/17d7f70a4d74a74992184a64abeb58f21546b8a5/docs/figure/stats.Rmd/mudminnow-1.png" target="_blank">17d7f70</a>
</td>
<td>
Dave Tang
</td>
<td>
2024-03-19
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>A square root transformation is used for data that are clumped and
the variance is greater than the mean. As there is no square root for
negative numbers, a constant needs to be added to each observation to
make all observations positive. Note that the square root of a fraction
becomes larger than the observation being transformed.</p>
<pre class="r"><code>x &lt;- 0.16
sqrt(x) &gt; x</code></pre>
<pre><code>[1] TRUE</code></pre>
<p>A reciprocal transformation is used when clumping of the data is very
high. Since the reciprocal of <span class="math inline">\(x\)</span> is
<span class="math inline">\(\frac{1}{x}\)</span>, the transformation
leads to large numbers being smaller after transformation than smaller
ones: <span class="math inline">\(\frac{1}{2} \gt
\frac{1}{10}\)</span>.</p>
<p>An arcsine transformation can be used to “stretch out” data points
that range between the values 0 and 1. This type of transformation is
typically used when dealing with proportions and percentages, especially
where high or low percentages are involved. However, it makes little
difference in the 30-70% range. In the code above, the raw counts were
divided by the maximum value to create percentage-like values.</p>
<pre class="r"><code>mudminnow |&gt;
  dplyr::filter(transformation == &quot;raw&quot;) |&gt;
  dplyr::pull(value) -&gt; x

x / max(x)</code></pre>
<pre><code> [1] 0.76 0.02 0.26 0.04 0.26 0.40 1.00 0.18 0.56 0.12 0.08 0.86</code></pre>
<pre class="r"><code>asin(sqrt(x / max(x)))</code></pre>
<pre><code> [1] 1.0588236 0.1418971 0.5350708 0.2013579 0.5350708 0.6847192 1.5707963
 [8] 0.4381490 0.8455431 0.3537416 0.2867566 1.1872993</code></pre>
<p>Data is transformed to make it suitable for statistical analysis and
subsequent statistical comparisons.</p>
</div>
</div>
<div id="type-1-and-type-2-errors" class="section level2">
<h2>Type 1 and Type 2 errors</h2>
<ul>
<li>A Type 1 error leads to a false positive, i.e., we erroneously claim
a difference where none exists.</li>
<li>A Type 2 error is the converse, a false negative, i.e., we fail to
identify a true difference.</li>
</ul>
<p>Convicting an innocent person is a Type 1 error and acquitting a
guilty one is a Type 2 error.</p>
</div>
<div id="comparing-means" class="section level2">
<h2>Comparing means</h2>
<p>Samples from a single source will always show some background
variation. When comparing means, we need some way of judging the
likelihood of a difference between two means occurring just by chance
from the background variation. The standard deviation can be used to
assess the likelihood of a single observation being picked from the
normal distribution. What metric do we use to judge the size of a
<strong>difference between two means</strong>? The <em>standard error of
a difference between two means</em> (s.e.d.m)! Note that <em>error</em>
replaces <em>deviation</em> when dealing with variations of means rather
than individual data.</p>
<div id="standard-error-of-a-difference-between-two-means"
class="section level3">
<h3>Standard error of a difference between two means</h3>
<p>This is one way to illustrate and calculate s.e.d.m. First we need a
collection of “means”; then we’ll calculate the differences between the
means; and finally we will calculate the variance of the differences,
which is the standard error!</p>
<p>Sample 300 eggs and calculate the means of three consecutive eggs to
get a collection of 100 means.</p>
<pre class="r"><code>raw_eggs &lt;- c(
  rep(61, 1),
  rep(62, 6),
  rep(63, 10),
  rep(64, 17),
  rep(65, 29),
  rep(66, 19),
  rep(67, 11),
  rep(68, 5),
  rep(69, 2)
)

set.seed(1984)
eggs &lt;- sample(x = raw_eggs, size = 300, replace = TRUE)

lapply(seq(from = 1, to = length(eggs), by = 3), function(x){
  eggs[x:(x+2)]
}) |&gt;
  sapply(X = _, mean) -&gt; egg_means

length(egg_means)</code></pre>
<pre><code>[1] 100</code></pre>
<p>Next, calculate the differences in means between each pair of
means.</p>
<pre class="r"><code>sapply(seq(from = 1, to = length(egg_means), by = 2), function(x){
  egg_means[x+1] - egg_means[x]
}) -&gt; egg_diffs

egg_diffs</code></pre>
<pre><code> [1]  0.3333333  2.0000000 -1.0000000  0.0000000 -0.3333333 -1.0000000
 [7] -0.3333333  2.6666667 -1.0000000  0.3333333 -2.6666667 -1.6666667
[13] -0.6666667  1.0000000  0.3333333  2.0000000  2.0000000  1.6666667
[19] -2.0000000  0.6666667  1.0000000  1.0000000 -1.6666667 -1.0000000
[25] -0.6666667  0.0000000  0.6666667 -1.0000000  2.0000000  0.3333333
[31] -2.6666667 -1.3333333 -1.6666667 -1.0000000 -1.3333333 -0.6666667
[37]  1.6666667 -1.6666667 -0.3333333  1.0000000  2.0000000  1.3333333
[43] -2.3333333  1.0000000  2.0000000 -1.3333333  0.6666667  1.3333333
[49] -1.3333333 -0.6666667</code></pre>
<p>Finally, we can calculate the standard error!</p>
<pre class="r"><code>sd(egg_diffs)</code></pre>
<pre><code>[1] 1.40619</code></pre>
<p>But for the sake of comparison, we will use this set of differences
as provided in the book.</p>
<pre class="r"><code>egg_diffs &lt;- c(0.67, 0, -0.67, -0.67, 2, 0.33, 0, 3.33, 1.33, 1.67, -0.67, -1.67, 1.67, -1.67, 1.33, 2, 1, -0.67, -1.33, 1.33, -1.33, 1, 0.67, -0.67, 1.33, 0.33, 1, 2.67, 0, -0.33, 1.67, 1.33, -2.67, 1.67, 1, -2, 0.33, 0.67, 0.33, 0.33, -2.33, 0, 0, 1, 0, -1, 1, -0.67, 0.67, 2.33)

sd(egg_diffs)</code></pre>
<pre><code>[1] 1.303365</code></pre>
<p>Here’s the most important concept to grasp:</p>
<p><strong>Just as we collect a bunch of numbers and calculate the
standard deviation to assess whether a newly collected number is likely
or not, we calculate the standard error of difference in means to assess
whether a newly collected difference in means is likely or
not!</strong></p>
<p>The standard error (of difference in means) can be used to judge
whether a difference between two means (based on three eggs) is a likely
or unlikely difference to sample within a single batch of eggs.</p>
</div>
<div id="standard-error-calculation" class="section level3">
<h3>Standard error calculation</h3>
<p>The standard error can simply be calculated by using the variance in
your samples and the number of samples; in the example above, this would
be the variance of the three eggs, which means the number of samples is
three.</p>
<p><strong>This is because the variance of individual samples has a very
simple relationship with the variance of means, and the variance of
differences</strong>.</p>
<p>For this section:</p>
<ul>
<li><span class="math inline">\(s\)</span> is for the standard
deviation, which is relevant to the variation among single data</li>
<li><span class="math inline">\(s^2\)</span> is for the variance of
individual data</li>
<li><span class="math inline">\(s.e.\)</span> for standard error (the
equivalent of <span class="math inline">\(s\)</span> for means)</li>
<li><span class="math inline">\(s.e.d.m.\)</span> for the standard error
of differences between means.</li>
</ul>
<div id="variance-of-a-sample-to-variance-of-means"
class="section level4">
<h4>Variance of a sample to variance of means</h4>
<p><strong>The variance of means of <span
class="math inline">\(n\)</span> numbers is the variance of the sample
divided by <span class="math inline">\(n\)</span></strong>.</p>
<p>Let’s demonstrate this! A set of 20 means were calculated by randomly
picking three eggs from <code>raw_eggs</code> and calculating their
means. We can then calculate the variance of this set of means.</p>
<pre class="r"><code>egg_means &lt;- c(63.67, 66.67, 63, 64.67, 65.33, 66.63, 64.67, 65, 65, 65.33, 64.33, 64, 64.67, 64, 64.33, 65.67, 64.67, 66.33, 65.67, 65)

var(egg_means)</code></pre>
<pre><code>[1] 0.9126379</code></pre>
<p>Now note that the variance of the means multiplied by <span
class="math inline">\(n\)</span> is close to the variance of
<code>raw_eggs</code>.</p>
<pre class="r"><code>var(egg_means) * 3</code></pre>
<pre><code>[1] 2.737914</code></pre>
<pre class="r"><code>var(raw_eggs)</code></pre>
<pre><code>[1] 2.694444</code></pre>
<p>Therefore, we can estimate the variance of means by taking the
variance of the data and dividing by the size of sample used to
calculate the means. Let’s see if this relationship holds for different
<span class="math inline">\(n\)</span>’s with a larger data set.</p>
<pre class="r"><code>set.seed(1984)
my_pop &lt;- rnorm(n = 1000000, mean = 50, sd = 25)

variance_of_means &lt;- function(n, nmeans=20, seed=1984){
  set.seed(seed)
  my_means &lt;- sapply(1:nmeans, function(x){
    mean(sample(x = my_pop, size = n, replace = TRUE))
  })
  v &lt;- c(var(my_means), var(my_pop) / n)
  names(v) &lt;- c(&#39;var_means&#39;, &#39;var_est&#39;)
  v
}

data.frame(
  n3 = variance_of_means(3),
  n10 = variance_of_means(10),
  n50 = variance_of_means(50),
  n100 = variance_of_means(100)
)</code></pre>
<pre><code>                n3      n10      n50     n100
var_means 169.1160 53.49289 10.66052 5.302893
var_est   209.1002 62.73006 12.54601 6.273006</code></pre>
<p>The standard error is the square root of the variance of the mean,
which we can estimate from the variance of the single data.</p>
<p><span class="math display">\[
s.e. = \sqrt{\frac{s^2}{n}} = \frac{s}{\sqrt{n}}
\]</span></p>
</div>
</div>
<div id="t-test" class="section level3">
<h3>t-test</h3>
<p>Manual calculation</p>
<pre class="r"><code>x &lt;- c(75, 72, 68, 66, 65, 65, 60, 58, 50, 48, 42, 40)
y &lt;- c(80, 76, 74, 70, 68, 68, 66, 65, 62, 58, 56, 43, 40, 39)

correction_factor &lt;- function(x){
  sum(x)^2 / length(x)
}

x_ss &lt;- sum(x^2) - correction_factor(x)
y_ss &lt;- sum(y^2) - correction_factor(y)

pooled_ss &lt;- x_ss + y_ss

pooled_sd &lt;- sqrt(pooled_ss / (length(x) + length(y) - 2))

sedm &lt;- pooled_sd * sqrt((1/length(x) + 1/length(y)))

tstat &lt;- (mean(x) - mean(y)) / sedm
tstat</code></pre>
<pre><code>[1] -0.5509239</code></pre>
<p>Using <code>t.test()</code>.</p>
<pre class="r"><code>test &lt;- t.test(x = x, y = y)
test$statistic</code></pre>
<pre><code>         t 
-0.5564689 </code></pre>
</div>
</div>
<div id="visualise" class="section level2">
<h2>Visualise</h2>
<p><a
href="https://en.wikipedia.org/wiki/Anscombe%27s_quartet">Anscombe’s
quartet</a>.</p>
<pre class="r"><code>eg1 &lt;- datasets::anscombe</code></pre>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>
Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.2 (2023-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 22.04.3 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

time zone: Etc/UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] ggridges_0.5.6  ggplot2_3.4.4   workflowr_1.7.1

loaded via a namespace (and not attached):
 [1] tidyr_1.3.0       sass_0.4.7        utf8_1.2.4        generics_0.1.3   
 [5] stringi_1.7.12    hms_1.1.3         digest_0.6.33     magrittr_2.0.3   
 [9] evaluate_0.22     grid_4.3.2        fastmap_1.1.1     rprojroot_2.0.3  
[13] jsonlite_1.8.7    processx_3.8.2    whisker_0.4.1     ps_1.7.5         
[17] promises_1.2.1    httr_1.4.7        purrr_1.0.2       fansi_1.0.5      
[21] scales_1.2.1      jquerylib_0.1.4   cli_3.6.1         rlang_1.1.1      
[25] crayon_1.5.2      munsell_0.5.0     bit64_4.0.5       withr_2.5.1      
[29] cachem_1.0.8      yaml_2.3.7        tools_4.3.2       parallel_4.3.2   
[33] tzdb_0.4.0        dplyr_1.1.3       colorspace_2.1-0  httpuv_1.6.12    
[37] vctrs_0.6.4       R6_2.5.1          lifecycle_1.0.3   git2r_0.32.0     
[41] stringr_1.5.0     fs_1.6.3          bit_4.0.5         vroom_1.6.4      
[45] pkgconfig_2.0.3   callr_3.7.3       pillar_1.9.0      bslib_0.5.1      
[49] later_1.3.1       gtable_0.3.4      glue_1.6.2        Rcpp_1.0.11      
[53] xfun_0.40         tibble_3.2.1      tidyselect_1.2.0  rstudioapi_0.15.0
[57] knitr_1.44        farver_2.1.1      htmltools_0.5.6.1 labeling_0.4.3   
[61] rmarkdown_2.25    readr_2.1.4       compiler_4.3.2    getPass_0.2-2    </code></pre>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
https://docs.mathjax.org/en/latest/web/configuration.html. This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
